// Starforce success/maintain/decrease/boom rates by server
// Format: { currentStar: [success, maintain, decrease, boom] }

export const preSaviorRates = {
  0: [0.95, 0.05, 0, 0],
  1: [0.9, 0.1, 0, 0],
  2: [0.85, 0.15, 0, 0],
  3: [0.85, 0.15, 0, 0],
  4: [0.80, 0.2, 0, 0],
  5: [0.75, 0.25, 0, 0],
  6: [0.7, 0.3, 0, 0],
  7: [0.65, 0.35, 0, 0],
  8: [0.6, 0.4, 0, 0],
  9: [0.55, 0.45, 0, 0],
  10: [0.5, 0.5, 0, 0],
  11: [0.45, 0, 0.55, 0],
  12: [0.4, 0.0, 0.594, 0.006],
  13: [0.35, 0.0, 0.637, 0.013],
  14: [0.3, 0.0, 0.686, 0.014],
  15: [0.3, 0.679, 0, 0.021],
  16: [0.3, 0.0, 0.679, 0.021],
  17: [0.3, 0.0, 0.679, 0.021],
  18: [0.3, 0.0, 0.672, 0.028],
  19: [0.3, 0.0, 0.672, 0.028],
  20: [0.3, 0.63, 0, 0.07],
  21: [0.3, 0, 0.63, 0.07],
  22: [0.03, 0.0, 0.776, 0.194],
  23: [0.02, 0.0, 0.686, 0.294],
  24: [0.01, 0.0, 0.594, 0.396]
}

export const kmsRates = {
  0: [0.95, 0.05, 0, 0],
  1: [0.9, 0.1, 0, 0],
  2: [0.85, 0.15, 0, 0],
  3: [0.85, 0.15, 0, 0],
  4: [0.80, 0.2, 0, 0],
  5: [0.75, 0.25, 0, 0],
  6: [0.7, 0.3, 0, 0],
  7: [0.65, 0.35, 0, 0],
  8: [0.6, 0.4, 0, 0],
  9: [0.55, 0.45, 0, 0],
  10: [0.5, 0.5, 0, 0],
  11: [0.45, 0.55, 0.0, 0.0],
  12: [0.4, 0.6, 0.0, 0.0],
  13: [0.35, 0.65, 0.0, 0.0],
  14: [0.3, 0.7, 0.0, 0.0],
  15: [0.3, 0.679, 0, 0.021],
  16: [0.3, 0.679, 0, 0.021],
  17: [0.15, 0.782, 0, 0.068],
  18: [0.15, 0.782, 0, 0.068],
  19: [0.15, 0.765, 0, 0.085],
  20: [0.3, 0.595, 0, 0.105],
  21: [0.15, 0.7225, 0, 0.1275],
  22: [0.15, 0.68, 0, 0.17],
  23: [0.10, 0.72, 0, 0.18],
  24: [0.10, 0.72, 0, 0.18],
  25: [0.10, 0.72, 0, 0.18],
  26: [0.07, 0.744, 0, 0.186],
  27: [0.05, 0.76, 0, 0.19],
  28: [0.03, 0.776, 0, 0.194],
  29: [0.01, 0.792, 0, 0.198]
}

export const saviorRates = {
  ...preSaviorRates,
  11: [0.45, 0.55, 0.0, 0.0],
  12: [0.4, 0.6, 0.0, 0.0],
  13: [0.35, 0.65, 0.0, 0.0],
  14: [0.3, 0.7, 0.0, 0.0],
}

// Source: https://tw.beanfun.com/beanfuncommon/EventAD_Mobile/EventAD.aspx?EventADID=8388
export const TMSRates = {
  ...saviorRates,
  15: [0.3, 0.595, 0, 0.1],
  16: [0.3, 0.0, 0.56, 0.14],
  17: [0.3, 0.0, 0.49, 0.21],
  18: [0.3, 0.0, 0.42, 0.28],
  19: [0.3, 0.0, 0.42, 0.28],
  20: [0.3, 0.35, 0, 0.35],
  21: [0.3, 0, 0.35, 0.35],
  22: [0.03, 0.0, 0.388, 0.582],
  23: [0.02, 0.0, 0.392, 0.588],
  24: [0.01, 0.0, 0.396, 0.594]
}

export const tyrantAEERates = {
  0: [1, 0, 0, 0],
  1: [0.9, 0.1, 0, 0],
  2: [0.8, 0.2, 0, 0],
  3: [0.7, 0.3, 0, 0],
  4: [0.6, 0.4, 0, 0],
  5: [0.5, 0.5, 0, 0],
  6: [0.4, 0.6, 0, 0],
  7: [0.3, 0.7, 0, 0],
  8: [0.2, 0.8, 0, 0],
  9: [0.1, 0.9, 0, 0],
  10: [0.05, 0.95, 0, 0],
  11: [0.04, 0.96, 0, 0],
  12: [0.03, 0.97, 0, 0],
  13: [0.02, 0.98, 0, 0],
  14: [0.01, 0.99, 0, 0],
}

export const tyrantRates = {
  0: [0.5, 0.5, 0, 0],
  1: [0.5, 0, 0.5, 0],
  2: [0.45, 0, 0.55, 0],
  3: [0.4, 0, 0.6, 0],
  4: [0.4, 0, 0.6, 0],
  5: [0.4, 0, 0.582, 0.018],
  6: [0.4, 0, 0.57, 0.03],
  7: [0.4, 0, 0.558, 0.042],
  8: [0.4, 0, 0.54, 0.06],
  9:  [0.37, 0, 0.5355, 0.0945],
  10: [0.35, 0, 0.52, 0.13],
  11: [0.35, 0, 0.4875, 0.1625],
  12: [0.03, 0, 0.485, 0.485],
  13: [0.02, 0, 0.49, 0.49],
  14: [0.01, 0, 0.495, 0.495],
}

// Map from server input value to the associated starforcing rates.
const SERVER_RATES = {
  "gms": kmsRates,
  "old": preSaviorRates,
  "gmsPre30": saviorRates,
  "tms": TMSRates,
  "tmsr": TMSRates,
  "kms": kmsRates
}

/**
 * Get rates for a specific server and item type
 * @param {string} server - Server identifier
 * @param {string} itemType - Item type ('normal' or 'tyrant')
 * @param {boolean} useAEE - Whether to use AEE rates for tyrant items
 * @returns {Object} Rate table
 */
export function getRates(server, itemType, useAEE = false) {
  if (itemType === "tyrant") {
    return useAEE ? tyrantAEERates : tyrantRates
  }
  return SERVER_RATES[server]
}
